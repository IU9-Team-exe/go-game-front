/* public/wgo.player.css - ВЕРСИЯ 6 (Стабильная структура + Стили) */

/* --- БАЗОВЫЕ СТИЛИ И ПЕРЕМЕННЫЕ --- */
:root {
    /* Переменные как в предыдущих версиях */
    --wgo-color-background: var(--color-background, #f8f4e9);
    --wgo-color-text: var(--color-text, #3a3226);
    --wgo-color-primary: var(--color-primary, #a67c52);
    --wgo-color-primary-dark: var(--color-primary-dark, #78350f);
    --wgo-color-primary-light: var(--color-primary-light, #e6d5b8);
    --wgo-color-border: var(--border-color, rgba(58, 50, 38, 0.15));
    --wgo-border-radius: var(--border-radius, 8px);
    --wgo-shadow-sm: var(--shadow-sm, 0 1px 2px 0 rgba(0, 0, 0, 0.05));
    --wgo-shadow-md: var(--shadow-md, 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06));
    --wgo-shadow-lg: var(--shadow-lg, 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05));
    --wgo-font-sans: 'Noto Sans JP', Calibri, Tahoma, Arial, sans-serif;
    --wgo-font-serif: 'Noto Serif SC', serif;
}

.wgo-player-main {
    font-family: var(--wgo-font-sans);
    color: var(--wgo-color-text);
    background-color: transparent;
    margin: 0 auto;
    width: 100%;
    line-height: 1.5;
    font-size: 15px;
    position: relative;
    box-sizing: border-box;
    -webkit-tap-highlight-color: rgba(0,0,0,0);
}
/* Используем clearfix для float-based layout WGo.js */
.wgo-player-main::after { content: ""; clear: both; display: table; }

/* --- СТРУКТУРА И РЕГИОНЫ --- */
/* Стили по умолчанию для регионов */
.wgo-player-top, .wgo-player-bottom,
.wgo-player-left, .wgo-player-right,
.wgo-player-center, .wgo-player-control {
    float: left; /* Возвращаем float для совместимости с логикой WGo.js */
    width: 100%; /* Занимают всю ширину по умолчанию */
    box-sizing: border-box;
    position: relative;
    margin: 0;
    padding: 0;
}
.wgo-player-left-wrapper, .wgo-player-right-wrapper { height: 100%; position: relative;}

/* Отступы между основными блоками (вертикальный макет) */
.wgo-player-top { margin-bottom: 12px; }
.wgo-player-control { margin-bottom: 8px; padding: 5px 0; } /* Панель управления */
.wgo-player-center { margin-bottom: 12px; } /* Доска */
.wgo-player-bottom { margin-bottom: 0; } /* Комментарии */

/* --- ДОСКА --- */
.wgo-player-board { display: flex; justify-content: center; align-items: center; width: 100%; position: relative; }
.wgo-board { margin: 0; background-color: var(--wgo-color-primary-light); border: 1px solid #d3c6a8; border-bottom: 3px solid var(--wgo-color-primary); border-right: 3px solid var(--wgo-color-primary); box-shadow: var(--wgo-shadow-md); border-radius: 5px; max-width: 100%; display: block; }
.wgo-board canvas { display: block; max-width: 100%; height: auto; }

/* --- ИНФОРМАЦИЯ ОБ ИГРОКАХ --- */
.wgo-infobox { display: flex; flex-direction: column; gap: 10px; width: 100%; } /* По умолчанию столбиком */
.wgo-box-wrapper.wgo-player-wrapper { background: rgba(255, 255, 255, 0.75); border: 1px solid var(--wgo-color-border); border-radius: var(--wgo-border-radius); box-shadow: var(--wgo-shadow-sm); padding: 10px 12px; box-sizing: border-box; }
.wgo-player-wrapper .wgo-box-title { margin: 0 0 8px 0; padding: 0 0 6px 0; padding-right: 22px; line-height: 1.3; font-weight: bold; font-size: 1.1em; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; background-color: transparent; border-bottom: 1px solid var(--wgo-color-border); color: var(--wgo-color-text); font-family: var(--wgo-font-serif); position: relative; }
.wgo-player-wrapper .wgo-box-title::after { content: ' '; position: absolute; right: 0; top: 50%; transform: translateY(-50%); width: 16px; height: 16px; border-radius: 50%; box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2); }
.wgo-player-wrapper.wgo-black .wgo-box-title::after { background: radial-gradient(circle at 30% 30%, #555, #222); }
.wgo-player-wrapper.wgo-white .wgo-box-title::after { background: radial-gradient(circle at 30% 30%, #fff, #eee); border: 1px solid #ccc; }
.wgo-player-info { padding: 0; display: flex; justify-content: space-between; gap: 5px; text-align: center; }
.wgo-player-info-box-wrapper { flex: 1; }
.wgo-player-info-box { padding: 0; border: none; background: none; }
.wgo-player-info-title { font-size: 0.75em; font-weight: 500; color: #666; margin-bottom: 2px; display: block; text-transform: uppercase; }
.wgo-player-info-value { font-weight: bold; font-size: 1.05em; }

/* --- ПАНЕЛЬ УПРАВЛЕНИЯ --- */
/* Контейнер для центрирования */
.wgo-player-control .wgo-control-wrapper { display: flex; justify-content: center; align-items: center; flex-wrap: wrap; gap: 5px; max-width: 500px; margin: 0 auto;}
.wgo-ctrlgroup-left, .wgo-ctrlgroup-right { display: none; }
.wgo-ctrlgroup-control { display: flex; align-items: center; gap: 5px; }
button.wgo-button { border: 1px solid var(--wgo-color-border); border-radius: var(--wgo-border-radius); background-color: rgba(255, 255, 255, 0.85); width: 40px; height: 40px; margin: 0; color: var(--wgo-color-primary-dark); transition: all 0.15s ease-out; box-shadow: var(--wgo-shadow-sm); padding: 0; display: inline-flex; align-items: center; justify-content: center; cursor: pointer; flex-shrink: 0; }
button.wgo-button:not([disabled]):hover { background-color: rgba(230, 213, 184, 0.7); border-color: var(--wgo-color-primary); box-shadow: var(--wgo-shadow-md); transform: translateY(-1px); }
button.wgo-button:not([disabled]):active { background-color: rgba(166, 124, 82, 0.5); border-color: var(--wgo-color-primary-dark); transform: scale(0.96); box-shadow: var(--wgo-shadow-sm); }
.wgo-button::before { font-size: 20px; line-height: 1; }
.wgo-button-first::before    { content: '⏮'; }
.wgo-button-multiprev::before{ content: '⏪'; }
.wgo-button-previous::before { content: '⏴'; font-size: 24px;}
.wgo-button-next::before     { content: '⏵'; font-size: 24px;}
.wgo-button-multinext::before{ content: '⏩'; }
.wgo-button-last::before     { content: '⏭'; }
.wgo-button-menu, .wgo-button-about { display: none; }
.wgo-button[disabled] { color: #aaa; background-color: rgba(230, 230, 230, 0.5); border-color: #ddd; box-shadow: none; cursor: not-allowed; }
.wgo-button[disabled]::before { opacity: 0.6; }
input[type="text"].wgo-player-mn-value { border: 1px solid var(--wgo-color-border); border-radius: var(--wgo-border-radius); background-color: rgba(255, 255, 255, 0.85); width: 3.5em; height: 40px; font-weight: bold; font-size: 1em; text-align: center; outline: 0; padding: 0 5px; box-sizing: border-box; color: var(--wgo-color-text); transition: all 0.15s ease-out; }
input[type="text"].wgo-player-mn-value:focus { border-color: var(--wgo-color-primary); box-shadow: 0 0 0 3px rgba(166, 124, 82, 0.2); }
input[type="text"].wgo-player-mn-value[disabled] { background-color: rgba(230, 230, 230, 0.5); border-color: #ddd; color: #aaa; box-shadow: none; cursor: not-allowed; }
.wgo-player-mn-wrapper { margin: 0; }

/* --- КОММЕНТАРИИ / GAME INFO --- */
.wgo-commentbox { width: 100%; }
.wgo-comments-wrapper { background: rgba(255, 255, 255, 0.75); border: 1px solid var(--wgo-color-border); border-radius: var(--wgo-border-radius); box-shadow: var(--wgo-shadow-sm); overflow: hidden; margin: 0; height: 100%; /* Занимает высоту родителя (важно для layout с колонкой) */ position: relative; box-sizing: border-box; display: flex; flex-direction: column; }
.wgo-commentbox .wgo-box-title { margin: 0; padding: 8px 12px; line-height: 1.4; font-weight: bold; font-size: 1.05em; background-color: rgba(58, 50, 38, 0.04); border-bottom: 1px solid var(--wgo-color-border); color: var(--wgo-color-text); font-family: var(--wgo-font-serif); border-radius: var(--wgo-border-radius) var(--wgo-border-radius) 0 0; flex-shrink: 0; }
.wgo-commentbox .wgo-box-title::after { display: none; }
.wgo-comments-content { padding: 10px 12px; border: 0; background-color: transparent; overflow-y: auto; /* max-height: 250px; - убираем макс высоту по умолчанию */ position: static; /* height: auto; - убираем авто */ font-size: 0.95em; flex-grow: 1; /* Растягиваем контент */ }
.wgo-comments-content p { margin: 0.5em 0; }
.wgo-help, .wgo-notification { padding: 8px 12px; margin-bottom: 10px; border-radius: 4px; font-size: 0.9em; }
.wgo-help { background-color: #fffbe6; border: 1px solid #ffe58f; }
.wgo-notification { background-color: #e6f7ff; border: 1px solid #91d5ff; }
.wgo-comments-nick { color: var(--wgo-color-primary-dark); font-weight: bold; margin-right: 5px; }
a.wgo-move-link { text-decoration: none; border-bottom: 1px dashed var(--wgo-color-primary); color: var(--wgo-color-primary-dark); font-weight: 500; }
a.wgo-move-link:hover { border-bottom-style: solid; color: var(--color-accent, #c0392b); }
.wgo-commentbox .wgo-info-list { display: grid; grid-template-columns: auto 1fr; gap: 4px 10px; width: 100%; margin-top: 8px; border: none; }
.wgo-commentbox .wgo-info-title { display: none; }
.wgo-commentbox .wgo-info-item { display: contents; }
.wgo-commentbox .wgo-info-label, .wgo-commentbox .wgo-info-value { display: block; border: none; padding: 2px 0; vertical-align: baseline; }
.wgo-commentbox .wgo-info-label { font-weight: 400; color: #555; text-align: right; font-size: 0.9em; }
.wgo-commentbox .wgo-info-value { font-weight: 500; text-align: left; }

/* --- СКРЫТЫЕ/ВСПОМОГАТЕЛЬНЫЕ ЭЛЕМЕНТЫ --- */
.wgo-info-overlay { /* ... */ }
.wgo-info-message { /* ... */ }
.wgo-player-menu { display: none !important; }

/* =========================================== */
/* --- АДАПТИВНАЯ КОМПОНОВКА (Медиа-запросы) --- */
/* =========================================== */

/* --- Планшеты и Десктопы (> 768px) --- */
@media screen and (min-width: 769px) {
    /* Активируем двухколоночный режим WGo.js */
    .wgo-player-main.wgo-twocols .wgo-player-center { width: calc(100% - 320px); /* Ширина доски = 100% - ширина боковой панели - отступ */ float: left;}
    .wgo-player-main.wgo-twocols .wgo-player-right { width: 300px; float: right; display: block; margin-left: 20px;} /* Фикс ширина правой панели */
    .wgo-player-main.wgo-twocols .wgo-player-left { display: none; } /* Скрываем левую, если вдруг появится */

    /* Отменяем центрирование для дочерних элементов */
    .wgo-player-main.wgo-twocols .wgo-player-top,
    .wgo-player-main.wgo-twocols .wgo-player-control,
    .wgo-player-main.wgo-twocols .wgo-player-center,
    .wgo-player-main.wgo-twocols .wgo-player-bottom {
        max-width: none; /* Убираем ограничение */
        justify-self: initial; /* Убираем центрирование */
    }

     /* Элементы управления под доской в левой колонке */
    .wgo-player-main.wgo-twocols .wgo-player-center .wgo-player-control {
        float: left; /* Важно для clearfix */
        width: 100%;
        margin-bottom: 8px;
        padding: 5px 0;
    }
     /* Доска под управлением */
    .wgo-player-main.wgo-twocols .wgo-player-center .wgo-player-board {
         float: left;
         width: 100%;
    }

    /* Элементы в правой колонке */
    .wgo-player-main.wgo-twocols .wgo-player-right-wrapper {
        height: 100%; /* Растягиваем обертку */
        display: flex;
        flex-direction: column;
        gap: 15px;
    }
    .wgo-player-main.wgo-twocols .wgo-infobox {
        width: 100%; /* Инфо занимает всю ширину колонки */
        flex-direction: column; /* Снова столбиком в правой колонке */
        gap: 10px;
    }
    .wgo-player-main.wgo-twocols .wgo-commentbox {
        width: 100%;
        flex-grow: 1; /* Комментарии занимают остаток высоты */
        display: flex; /* Для растягивания */
        flex-direction: column;
    }
    .wgo-player-main.wgo-twocols .wgo-comments-wrapper {
        flex-grow: 1; /* Растягиваем обертку комментариев */
        display: flex;
        flex-direction: column;
    }
    .wgo-player-main.wgo-twocols .wgo-comments-content {
         flex-grow: 1; /* Растягиваем контент */
         max-height: none; /* Снимаем ограничение высоты */
    }
}

/* --- Маленькие Планшеты (до 768px) --- */
@media screen and (max-width: 768px) {
    /* Остается вертикальный макет по умолчанию */
    .wgo-player-main { padding: 15px; }
    .wgo-player-top, .wgo-player-control, .wgo-player-center, .wgo-player-bottom {
        max-width: 600px; /* Ограничиваем ширину контента */
    }
    .wgo-infobox { flex-direction: row; } /* Инфо рядом */
}

/* --- Мобильные (< 500px) --- */
@media screen and (max-width: 500px) {
    .wgo-player-main { padding: 10px; }
    .wgo-player-top, .wgo-player-control, .wgo-player-center, .wgo-player-bottom {
        max-width: 100%; /* На всю ширину */
    }
    .wgo-infobox { flex-direction: column; gap: 8px; } /* Инфо столбиком */
    .wgo-box-wrapper.wgo-player-wrapper { min-width: 0; }
    .wgo-button-multiprev, .wgo-button-multinext { display: none; }
    button.wgo-button { width: 36px; height: 36px; }
    button.wgo-button::before { font-size: 18px; }
    .wgo-button-previous::before, .wgo-button-next::before { font-size: 20px;}
    input[type="text"].wgo-player-mn-value { height: 36px; width: 3.2em; font-size: 0.95em; }
    .wgo-comments-content { max-height: 150px; font-size: 0.9em; }
}